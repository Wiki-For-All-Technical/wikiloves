[uwsgi]
# uWSGI configuration for Toolforge Flask app
# This file should be deployed to $HOME/www/python/uwsgi.ini

# Application
module = app:app
pythonpath = /data/project/wikiloves-data/www/python/src
chdir = /data/project/wikiloves-data/www/python/src

# Server
# Keep processes*threads low to avoid exceeding DB max_user_connections (10)
http-socket = :8000
processes = 1
threads = 2
master = true

# Logging
logto = /data/project/wikiloves-data/shared/logs/uwsgi.log

# Performance
enable-threads = true
lazy-apps = true
single-interpreter = true

# Headers
route = .* addheader:Access-Control-Allow-Origin: *
route = .* addheader:Access-Control-Allow-Methods: GET,POST,OPTIONS
route = .* addheader:Access-Control-Allow-Headers: Content-Type

# Memory limits
limit-as = 512
reload-on-as = 400
reload-on-rss = 200
